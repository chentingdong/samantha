generator prisma_client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url = "***"
}

enum State {
  DRAFT
  PENDING
  ACTIVE
  COMPLETE
}

enum BlockType {
  COMPOSITE_PARALLEL
  COMPOSITE_SEQUENTIAL
  LEAF_FORM
  LEAF_API
}

model User {
  id              String  @id
  name            String
  email           String
  requestedBlocks Block[] @relation("requestors", references: [id])
  respondedBlocks Block[] @relation("responders", references: [id])
}

model Block {
  id          Int       @default(autoincrement()) @id
  name        String
  description String    @default("")
  type        BlockType @default(COMPOSITE_PARALLEL)
  inCatalog   Boolean   @default(false)
  state       State     @default(DRAFT)
  control     String    @default("{}")
  context     String    @default("{}")
  parentId    Int?      @map("parent")
  parent      Block?    @relation("parentChildren", fields: [parentId], references: [id])
  children    Block[]   @relation("parentChildren")
  requestors  User[]    @relation("requestors", references: [id])
  responders  User[]    @relation("responders", references: [id])
}