# Migration `20200617223005`

This migration has been generated by chentingdong at 6/17/2020, 10:30:05 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Action" (
"id" text  NOT NULL ,"name" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id"))

ALTER TABLE "public"."Block" ADD COLUMN "actions" text  NOT NULL DEFAULT '[]',
ALTER COLUMN "state" SET DEFAULT 'DRAFT',
ALTER COLUMN "type" SET DEFAULT 'COMPOSITE_PARALLEL';

ALTER TABLE "public"."BlockDef" ADD COLUMN "actions" text  NOT NULL DEFAULT '[]',
ALTER COLUMN "type" SET DEFAULT 'COMPOSITE_PARALLEL';
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200603211157-add-delete-state..20200617223005
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 enum State {
   DELETE
@@ -37,8 +37,10 @@
   type         BlockType @default(COMPOSITE_PARALLEL)
   state        State     @default(DRAFT)
   control      String    @default("{}")
   context      String    @default("{}")
+  actions      String    @default("[]")
+  // actions      String    @relation("blockAction", fields: [actionId], references: [id])
   parentId     String?   @map("parent")
   parent       Block?    @relation("parentChildren", fields: [parentId], references: [id])
   children     Block[]   @relation("parentChildren")
   requestors   User[]    @relation("requestors", references: [id])
@@ -47,15 +49,21 @@
   last_updated DateTime  @default(now())
   due_date     DateTime?
 }
+model Action {
+  id    String  @id
+  name  String  @default("")
+}
+
 model BlockDef {
   id           String     @id
   name         String     @default("")
   description  String     @default("")
   type         BlockType  @default(COMPOSITE_PARALLEL)
   control      String     @default("{}")
   context      String     @default("{}")
+  actions      String     @default("[]")
   parentId     String?    @map("parent")
   parent       BlockDef?  @relation("blockDefParentChildren", fields: [parentId], references: [id])
   children     BlockDef[] @relation("blockDefParentChildren")
   created_at   DateTime   @default(now())
```


