AWSTemplateFormatVersion: "2010-09-09"
Outputs:
  DeploymentHistoryTag:
    Description: Stackery Deployment History Tag
    Value: H1KXM2
Parameters:
  DeploymentTimestamp:
    Default: "1578702129042"
    Description: Deployment preparation timestamp in milliseconds Since Epoch (injected
      by Stackery at deployment time)
    Type: Number
  EnvironmentTagName:
    Default: test
    Description: Environment Name (injected by Stackery at deployment time)
    Type: String
  StackTagName:
    Default: samantha
    Description: Stack Name (injected by Stackery at deployment time)
    Type: String
Resources:
  DeployPocUI:
    DependsOn: DeploymentMarkerTagH1KXM2
    Properties:
      CodeUri: ./
      Description:
        Fn::Sub:
        - Stack ${StackTagName} Environment ${EnvironmentTagName} Function ${ResourceName}
        - ResourceName: DeployPocUI
      Environment:
        Variables:
          BUCKET_ARN:
            Fn::GetAtt:
            - PocUI
            - Arn
          BUCKET_NAME:
            Ref: PocUI
      FunctionName:
        Fn::Sub: ${AWS::StackName}-DeployPocUI
      Handler: index.handler
      MemorySize: 3008
      Policies:
      - AWSXrayWriteOnlyAccess
      - S3CrudPolicy:
          BucketName:
            Ref: PocUI
      Runtime: nodejs12.x
      Timeout: 30
      Tracing: Active
    Type: AWS::Serverless::Function
  DeployPocUIDeployTrigger:
    DependsOn: DeploymentMarkerTagH1KXM2
    Properties:
      DeploymentTimestamp:
        Ref: DeploymentTimestamp
      ServiceToken:
        Fn::GetAtt:
        - DeployPocUI
        - Arn
    Type: Custom::FunctionDeployTrigger
  DeploymentMarkerTagH1KXM2:
    Type: AWS::CloudFormation::WaitConditionHandle
  PocUI:
    DependsOn: DeploymentMarkerTagH1KXM2
    Properties:
      BucketName:
        Fn::Sub: ${AWS::StackName}-pocui-${AWS::AccountId}
      WebsiteConfiguration:
        IndexDocument: index.html
    Type: AWS::S3::Bucket
Transform: AWS::Serverless-2016-10-31
